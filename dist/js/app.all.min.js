(function(){"use strict";angular.module("templates",[])})();angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("js/modules/main/main.tooltip.tpl.html",'<div id="tooltip">\n    <div class="my-scroll-area" ng-nicescroll nice-option="{cursorcolor: \'#e2edff\'}">\n\n\n    </div>\n</div>\n');$templateCache.put("js/modules/main/main.tpl.html",'<div class="off-canvas__container off-canvas__content" ng-class="main.showInfo ? \'info\' : \'\'">\n    <div class="my-scroll-area full-height" ng-nicescroll nice-option="{cursorcolor: \'#e2edff\'}">\n        <div class="container-fluid">\n            <nav class="nav navbar-nav">\n\n                <ul class="nav navbar-nav">\n                    <li class="pull-left">\n                        <a href="#" ng-click="main.toggle()" ng-style="{\'visibility\': main.selectedPieces ? \'visible\' : \'hidden\'}"> <i class="fa fa-terminal"></i></a>\n\n\n                    </li>\n                    <li> <a href="http://pavelzajic.cz" target="_blank">#zajic</a></li>\n                    <li>\n                        <a href="http://nakladatelstvi.hostbrno.cz/nakladatelstvi/poezie/ostatni/nejlepsi-ceske-basne-2015-1140" target="_blank">#b2015</a>\n                    </li>\n                    <li class="pull-right">\n\n\n                        <a href="#" ng-click="main.toggleShowInfo()">\n                            <i class="fa fa-question " ng-class="main.showInfo ? \'black\' : \'\'">\n                            </i>\n                        </a>\n                    </li>\n                </ul>\n            </nav>\n            <div class="clearfix">\n\n\n            </div>\n            <div class="center">\n                <div ng-show="main.showInfo" class="info-block" style="{min-height: main.getInfoBoxHeight()}">\n                    <p>\n                        Někdy v období mezi střední školou, nástupem na vysokou či prvním skutečným zaměstnáním číhá na mladého člověka možnost opravdové svobody, opravdových přátelství a opravdové finanční nezávislosti. Škála proroků šířících výše vypsaná pozitiva se rekrutuje nejčastěji z řad vašich opravdu blízkých náhodných známých, kteří dostali dar rozeznat vaši skutečnou lidskost.\n                    </p>\n                    <p>\n                        „Jsme přesvědčeni, že je nutné tuto dovednost prohlubovat převážně u mladých lidí, kteří nemají cestu ke svobodě zkalenou nadbytečnými životními zkušenostmi. Známe tvoje sny, a tady ti dáváme prostředek/nástroj, jak je realizovat.“\n                    </p>\n                    <p>\n                        Do jaké míry jsme vlastně schopni sami svobodně rozhodnout o své budoucnosti? Je možné, že tento druh svobody je ve skutečnosti naším tiše trpěným pokrytectvím? Třeba je opravdu potřeba vtěsnat tu nespecifikovanou motivaci do symbolu — diamantu. Třeba bude opravdu lépe, když za nás velká rozhodnutí budou dělat jiní.\n                    </p>\n                    <p>\n                        text: Pavel Zajíc (1988)\n                        <br /> Básník. Vystudoval Sdružená uměnovědná studia na Masarykově univerzitě v Brně. Zpívá bas v mužském sboru Láska opravdivá. Básně publikoval v různých literárních časopisech, knižně vydal sbírku básní Ona místa (2013) a k vydání připravuje sbírku druhou s názvem peníze.\n                        <br />\n                        <a href="http://pavelzajic.cz" target="_blank">pavelzajic.cz</a>\n                    </p>\n\n                    <p>\n                        Knihu nejlepší české básně 2015 kupte u nakladatelství <a href="http://nakladatelstvi.hostbrno.cz/nakladatelstvi/poezie/ostatni/nejlepsi-ceske-basne-2015-1140" target="_blank">Host</a>\n\n                    </p>\n                </div>\n                <div class="copy" id="copy" ng-show="main.showInfo">\n                    &copy; 2015 <a href="http://www.jansmejkal.cz" target="_blank">Jan Smejkal</a>\n                </div>\n                <div ng-repeat="piece in main.pieces " class="gridelem " ng-click="main.addToPlaylist(piece) " ng-hide="main.showInfo" ng-class="{next : piece.isNext, clicked : piece.isClicked}">\n                    <div class="square-content">\n                        <div><span>\n                                {{piece.text}}\n                       </span></div>\n                    </div>\n                    <div class="number ">{{piece.number}}</div>\n                </div>\n            </div>\n        </div>\n\n    </div>\n');$templateCache.put("js/modules/off-canvas/off-canvas.tpl.html",'<div class="off-canvas__nav">\n    <div class="my-scroll-area full-height" ng-nicescroll nice-option="{cursorcolor: \'#e2edff\'}">\n        <div class="container-fluid">\n\n\n            <nav class="nav navbar-nav">\n\n                <ul class="nav navbar-nav">\n                    <li class="pull-left">\n                        <a href="#" ng-click="mediaPlayer.play(0, false) " ng-show="offCanvas.playlist.length>0"><i class="fa fa-volume-up" ></i></a>\n                    </li>\n                    <li>\n                        <a href="#" ng-click="offCanvas.resetPlaylist()"><i class="fa fa-power-off" ></i></a>\n                    </li>\n                    <li class="pull-right"><a href="#" ng-click="offCanvas.toggle()"><i class="fa fa-caret-right"></i></a></li>\n                </ul>\n            </nav>\n            <a href="#" socialshare socialshare-provider="twitter" socialshare-text="720kb angular-socialshare" socialshare-url="http://720kb.net">\nShare me\n</a>\n\n            <p class="poem ">\n                {{offCanvas.poem}}\n            </p>\n\n            <audio media-player="mediaPlayer " data-playlist="offCanvas.playlist ">\n                <source src="" type="">\n            </audio>\n        </div>\n    </div>\n\n</div>\n')}]);(function(){angular.module("poemApp",["ui.router","ui.bootstrap","cn.offCanvas","mediaPlayer","config","angular-nicescroll","templates","720kb.socialshare"]).config(["$stateProvider","$urlRouterProvider","$httpProvider",function($stateProvider,$urlRouterProvider,$httpProvider){$urlRouterProvider.otherwise("/home")}])})();(function(){angular.module("poemApp").config(function($stateProvider){$stateProvider.state("home",{url:"/home",templateUrl:"js/modules/main/main.tpl.html",controller:"MainController",controllerAs:"main"})})})();(function(){angular.module("poemApp").controller("MainController",mainController);mainController.$inject=["CONFIG","$scope","$rootScope","$filter","$templateCache","$timeout","myOffCanvas","mainService"];function mainController(CONFIG,$scope,$rootScope,$filter,$templateCache,$timeout,myOffCanvas,mainService){var main=this;main.showInfo=false;main.pieces=mainService.shuffleArray(mainService.createPieces());main.selectedPieces=false;main.clickInProgress=false;main.toggle=myOffCanvas.toggle;main.toggleShowInfo=function(){main.showInfo=!main.showInfo};main.addToPlaylist=function(piece){if(!main.clickInProgress){main.clickInProgress=true;$timeout(function(){mainService.addToPlaylist(piece);$rootScope.$broadcast("pieceAdded");main.selectedPieces=true;var wasNextIndex=$filter("findPieceByProperty")("isNext",true,main.pieces);var wasClickedIndex=$filter("findPieceByProperty")("isClicked",true,main.pieces);console.log("wasNextIndex:",wasNextIndex);console.log("wasClickedIndex:",wasClickedIndex);if(wasNextIndex){console.log("wasNext:",main.pieces[wasNextIndex]);main.pieces[wasNextIndex].isNext=false}if(wasClickedIndex){main.pieces[wasClickedIndex].isClicked=false}var isClickedIndex=main.pieces.indexOf(piece);var isClickedId=main.pieces[isClickedIndex].id;console.log("isClickedId:",isClickedId);restQueueParams();main.pieces[isClickedIndex].isClicked=true;if(isClickedId<=main.pieces.length-1){var lookedId=parseInt(isClickedId)+1;console.log("lookedId:",lookedId);var nextId=$filter("findPieceByProperty")("id",parseInt(lookedId),main.pieces);main.pieces[nextId].isNext=true}main.pieces=mainService.shuffleArray(main.pieces);main.clickInProgress=false},250)}};main.toggleTooltip=function(){main.popoverOpen=!main.popoverOpen;console.log("main.popoverOpen:",main.popoverOpen)};$scope.$on("resetPlaylist",function(){main.pieces=mainService.shuffleArray(mainService.createPieces());var nextId=$filter("findPieceByProperty")("id",1,main.pieces);main.pieces[nextId].isNext=true;main.selectedPieces=false});main.getInfoBoxHeight=function(){var viewportHeight=Math.max(document.documentElement.clientHeight,window.innerHeight||0);var menuHeight=angular.element(document.getElementsByTagName("nav")).clientHeight;var copyHeight=angular.element(document.getElementById("copy")).clientHeight;return viewportHeight-menuHeight-copyHeight+"px"};function restQueueParams(){angular.forEach(main.pieces,function(piece){piece.isClicked=false;piece.isNext=false})}}})();(function(){"use strict";angular.module("poemApp").factory("mainService",mainService);mainService.$inject=["CONFIG"];function mainService(CONFIG){var factory={createPieces:createPieces,shuffleArray:shuffleArray,playlist:[],getPlaylist:getPlaylist,addToPlaylist:addToPlaylist,resetPlaylist:resetPlaylist};return factory;function createPieces(){var pieces=[];for(var i=0;i<CONFIG.tracks.length;i++){var piece={id:CONFIG.tracks[i].id,number:i+1,text:CONFIG.tracks[i].text,filename:CONFIG.tracks[i].file_name+"."+CONFIG.formats[0],isClicked:false,isNext:false};if(CONFIG.tracks[i].id==1)piece.isNext=true;pieces.push(piece)}console.log("pieces:",pieces);return pieces}function shuffleArray(array){var currentIndex=array.length,temporaryValue,randomIndex;while(0!==currentIndex){randomIndex=Math.floor(Math.random()*currentIndex);currentIndex-=1;temporaryValue=array[currentIndex];array[currentIndex]=array[randomIndex];array[randomIndex]=temporaryValue}return array}function addToPlaylist(track){factory.playlist.push(track)}function getPlaylist(){return factory.playlist}function resetPlaylist(){factory.playlist=[]}}})();(function(){"use strict";angular.module("poemApp").controller("MyOffCanvasCtrl",offCanvasCtrl);offCanvasCtrl.$inject=["myOffCanvas","CONFIG","$rootScope","$scope","$filter","mainService"];function offCanvasCtrl(myOffCanvas,CONFIG,$rootScope,$scope,$filter,mainService){var offCanvas=this;offCanvas.playlist=[];offCanvas.wtf=[];offCanvas.socialText=CONFIG.socialText;offCanvas.poem="";console.log("mainService.getPlaylist():",mainService.getPlaylist());offCanvas.getPlaylist=function(){$scope.mediaPlayer.stop();offCanvas.playlist=[];offCanvas.poem="";angular.forEach(angular.copy(mainService.getPlaylist()),function(track){offCanvas.poem+=" "+track.text;offCanvas.playlist.push($filter("convertToTrack")(angular.copy(track)))})};offCanvas.resetPlaylist=function(){$rootScope.$broadcast("resetPlaylist");mainService.resetPlaylist();offCanvas.getPlaylist();offCanvas.toggle()};$scope.$on("pieceAdded",function(evt){offCanvas.getPlaylist()});offCanvas.toggle=myOffCanvas.toggle}})();(function(){angular.module("poemApp").factory("myOffCanvas",myOffCanvas);myOffCanvas.$inject=["cnOffCanvas"];function myOffCanvas(cnOffCanvas){return cnOffCanvas({controller:"MyOffCanvasCtrl",controllerAs:"offCanvas",templateUrl:"js/modules/off-canvas/off-canvas.tpl.html"})}})();(function(){"use strict";angular.module("poemApp").filter("convertToTrack",convertToTrack);convertToTrack.$inject=["CONFIG"];function convertToTrack(CONFIG){return function(track){var newTrack={src:CONFIG.tracks_folder+track.filename,type:"audio/"+CONFIG.formats[0]};return newTrack}}})();(function(){"use strict";angular.module("poemApp").filter("findPieceByProperty",findPieceByProperty);findPieceByProperty.$inject=[];function findPieceByProperty(){return function(property,value,pieces){var elIndex=null;angular.forEach(pieces,function(piece){if(piece[property]==value){elIndex=pieces.indexOf(piece)}});console.log(elIndex);return elIndex}}})();